---
applyTo: "**"
description: Coding agent workflow, tool priority, MCP usage rules
excludeAgent:
  - "code-review"
---

# Global Coding Agent Guidelines

Project-level instructions (`CLAUDE.md`, `AGENTS.md`)
take precedence over this document.

## Workflow (Always Follow)

1. **Read** project instructions first (`CLAUDE.md`, `AGENTS.md`)
2. **Confirm** scope—implement exactly what is requested,
   ask 1–3 questions if ambiguous
3. **Explore** before coding—read files/URLs first,
   use subagents for investigation
4. **Plan** then execute stepwise:
   skeleton → minimal change → validate → refine
5. **Gather context** using tools before guessing
   (Context7 for docs, Serena for code)
6. **Change minimally** but completely—
   fix dependent artifacts in same change-set
7. **Validate** narrowly—run relevant checks only,
   report unrelated failures
8. **Report** outcome: what changed, where, what validation ran

### Extended Thinking Triggers

Use for complex problems:
`"think"` → `"think hard"` → `"think harder"` → `"ultrathink"`

## Core Principles

### Source of Truth

Priority: `clarifications.md` > spec > plan > tasks.
Repository artifacts are authoritative.

### Scope Control

- Implement only what is requested—no scope creep
- If artifacts conflict, update lower-priority
  to match higher-priority source
- Keep spec/plan/tasks consistent;
  update when implementation reveals gaps

### Output

- Default: 3–6 sentences or ≤5 bullets
- Multi-file work: Changes / Location / Risks / Validation / Next

## Do NOT

- Invent APIs, paths, line numbers, or tool outputs
- Create commits/branches/PRs/issues unless instructed
- Introduce secrets into code, examples, or docs
- Add commented-out code or provenance notes ("generated by...")
- Fix unrelated failures or change lockfiles unnecessarily
- Skip validation or make assumptions about behavior
- Guess when tools can provide facts—use tools first

## Uncertainty and Risk

- If external facts may have changed and tools are unavailable,
  note uncertainty explicitly
- Before high-risk operations (deletion, migrations, infra),
  self-check for hidden assumptions

## Tools

### Priority Order

1. **IDE-native** tools (best fidelity)
2. **MCP tools** (when IDE insufficient)
3. **Terminal** (lowest priority—avoid for code execution)

### MCP Quick Reference

| MCP                 | Use For                                    |
| ------------------- | ------------------------------------------ |
| Context7            | Library/API docs, setup steps              |
| Serena              | Symbol navigation, usage tracing, memory   |
| JetBrains           | Symbol nav, rename, find usages, run cfg   |
| ripgrep             | Fast broad text search                     |
| fetch               | External web content                       |
| markitdown          | PDF/Office document extraction             |
| git                 | Diffs, history, blame                      |
| sequential-thinking | Complex multi-step decisions               |
| memory              | Persistent notes (prefix: `yyyy-MM-dd-`)   |

MCP rules apply only when that server is available.
**Use MCP tools aggressively**—they provide better context
and accuracy than manual inspection.

### MCP Failure Handling

When an MCP tool call fails or times out:

1. **Do not retry with identical parameters**—
   adjust the query or try alternative tools
2. **Report the failure** briefly and continue with alternatives
3. If all alternatives fail, explain what was attempted
   and ask for guidance

### Terminal Rules

- Save to file (using IDE or tools) + use IDE runners
  instead of `python -c "..."` or `node -e "..."`
- For large inputs (>1KB): write to temp file first, then pipe/redirect

## Iterative Processing

- Work in small slices: implement → validate → proceed
- Keep intermediate states safe and reviewable
- For complex multi-step tasks (migrations, bulk fixes):
  use a checklist file

## Parallelism

- **Parallel reads**: docs + code search + repo inspection simultaneously
- **Sequential writes**: avoid parallel writes to same files
- **Subagents**: use for independent investigations early in conversation

## Internationalization: Korean Output

### Pattern Rules

Do not translate: code blocks, backtick content,
CamelCase/snake_case identifiers, paths with `.`/`/`/`[]`,
ALL_CAPS acronyms, proper nouns, reserved words.

### Protected Terms (Compact)

**Languages**: JavaScript, TypeScript, Python, Java, Kotlin,
Go, Rust, Node.js, JVM

**Frameworks**: React, Vue, Next.js, Spring, Django,
FastAPI, Hibernate, JPA

**Infra**: Docker, Kubernetes, AWS, GCP, Azure,
PostgreSQL, MongoDB, Redis, Kafka

**Patterns**: MVC, DDD, CQRS, microservice,
event sourcing, hexagonal architecture

**Operations**: CRUD, sync, async, transaction, cache,
batch, pub/sub, circuit breaker

**Agent**: workflow, phase, spec, plan, tasks,
Claude, Copilot, MCP, ultrathink

**Output**: Protected terms → verbatim. All else → fluent Korean.
